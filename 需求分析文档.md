# 刷刷题系统需求分析文档

## 1. 任务概述

本项目旨在开发一个智能题库管理与练习系统。该系统的核心目标是利用先进技术，实现对各类题库文档的自动化处理、高效管理和灵活的练习与刷题功能。通过自动化提取、智能分类和多样化的学习模式，本系统将显著提高用户管理题库的效率，并为用户提供个性化的学习体验，帮助用户更好地巩固知识、找出薄弱环节。

## 2. 数据描述
### 2.1 静态数据
题目信息： 题目的文本内容、题型（单选、多选、判断、填空）、选项、正确答案、解析、所属分类ID。

分类信息： 分类名称、创建时间。

用户信息： 用户名、密码（加密存储）、用户身份等。

系统配置： 大模型API密钥、文件存储路径等系统运行所需的基础配置信息。

### 2.2 动态数据
文件上传记录： 用户上传的文件名、上传时间、处理状态（进行中、已完成、失败）。

题目练习记录： 用户每次练习的题目ID、作答结果、用时、练习时间、是否加入错题本、是否收藏。

用户操作日志： 用户登录、登出、题目增删改查、分类管理等操作记录。

系统健康状态： 后端服务运行状态、数据库连接状态、API调用成功率等监控数据。

### 2.3 数据库设计
本系统将采用关系型数据库（MySQL）进行数据存储，以确保数据的一致性、完整性和支持复杂的关联查询。核心数据库表设计如下：

**用户表 (users):**
- id (Primary Key): 用户唯一标识
- username (String, Unique): 用户名
- email (String, Unique): 邮箱地址
- password_hash (String): 密码的哈希值
- role (String): 用户角色（admin, user）
- is_active (Boolean): 账户是否激活
- created_at (Timestamp): 用户创建时间
- updated_at (Timestamp): 用户信息更新时间

**分类表 (categories):**
- id (Primary Key): 分类唯一标识
- name (String): 分类名称
- description (Text): 分类描述
- user_id (Foreign Key): 所属用户ID
- is_default (Boolean): 是否为默认分类
- created_at (Timestamp): 分类创建时间
- updated_at (Timestamp): 分类更新时间

**题目表 (questions):**
- id (Primary Key): 题目唯一标识
- category_id (Foreign Key): 所属分类ID
- user_id (Foreign Key): 创建用户ID
- type (Enum): 题型（single_choice, multiple_choice, true_false, fill_blank）
- content (Text): 题目文本
- options (JSON): 题目选项（如果适用）
- answer (JSON): 正确答案
- explanation (Text): 题目解析
- difficulty (Integer): 难度等级（1-5）
- source_file (String): 来源文件名
- tags (JSON): 题目标签
- is_active (Boolean): 是否启用
- created_at (Timestamp): 题目创建时间
- updated_at (Timestamp): 题目最后更新时间

**练习记录表 (practice_records):**
- id (Primary Key): 记录唯一标识
- user_id (Foreign Key): 用户ID
- question_id (Foreign Key): 题目ID
- session_id (String): 练习会话ID
- user_answer (JSON): 用户作答
- is_correct (Boolean): 是否答对
- duration_seconds (Integer): 作答用时
- practice_mode (String): 练习模式（practice, review）
- practiced_at (Timestamp): 练习时间

**错题本表 (wrong_answers):**
- id (Primary Key): 记录唯一标识
- user_id (Foreign Key): 用户ID
- question_id (Foreign Key): 题目ID
- error_count (Integer): 错误次数
- last_error_at (Timestamp): 最后错误时间
- is_mastered (Boolean): 是否已掌握
- added_at (Timestamp): 加入错题本时间

**收藏夹表 (favorites):**
- id (Primary Key): 记录唯一标识
- user_id (Foreign Key): 用户ID
- question_id (Foreign Key): 题目ID
- notes (Text): 收藏备注
- added_at (Timestamp): 加入收藏夹时间

**文件上传记录表 (upload_records):**
- id (Primary Key): 记录唯一标识
- user_id (Foreign Key): 用户ID
- filename (String): 原始文件名
- file_path (String): 存储路径
- file_size (Integer): 文件大小
- file_type (String): 文件类型
- status (Enum): 处理状态（pending, processing, completed, failed）
- extracted_count (Integer): 提取题目数量
- error_message (Text): 错误信息
- uploaded_at (Timestamp): 上传时间
- processed_at (Timestamp): 处理完成时间

### 2.4 数据采集
数据采集是系统获取用户及题库信息的基础，主要包括以下要点和流程：

用户数据采集：

注册信息： 用户在注册时提供的用户名、密码等基本信息。

偏好数据： 用户在系统中的选择和设置，例如收藏的题目、练习模式设置等。

互动记录： 用户在练习、刷题、修改题目等过程中的行为数据。

题库数据采集：

文件上传： 用户通过系统界面上传Word、图片、PDF等格式的题库文档。后端服务接收文件后，调用文件解析库（如 python-docx、PyPDF2、Pillow）进行预处理，然后将文本或图像数据通过API发送给指定的大模型（例如硅基流动）进行内容提取、题型识别和结构化（转换为JSON格式）。

手动录入： 用户通过前端表单逐条添加题目信息，包括题目文本、题型、选项、答案、解析及所属分类。

数据采集流程：

数据源识别： 明确用户注册表单、用户操作行为、上传的题库文件等作为数据源。

数据采集程序： 后端服务负责文件上传的接收与解析，并调用大模型API进行数据提取。对于手动添加，前端通过API提交数据至后端。

数据清洗与处理： 接收到的数据会进行必要的格式校验、去重和结构化处理，确保数据质量。

数据存储： 经过处理的数据最终存储到关系型数据库中，并建立必要的索引以支持快速检索。

## 3. 功能需求
### 3.1 核心功能 (MVP)
智能题库文档上传与提取：

支持用户上传Word、图片（JPG, PNG等）和PDF格式的题库文档。

后端调用文件解析库对文档进行预处理。

通过API将文本或图像数据发送给指定大模型进行内容提取、题型识别和结构化（转换为JSON格式），支持单选、多选、判断、填空题型。

题库管理（分类、增删改查、筛选）：

系统根据文件名默认对提取的题目进行分类。

用户可手动创建、修改、删除新的分类。

支持对题目的查看、添加（手动添加）、删除、修改操作。

支持对题目进行基于分类的简单查询和筛选。

支持将题目批量或单个移动到指定分类下。

题目练习模式：

用户可以选择指定分类的题目进行练习。

支持设置练习时长、题目顺序（顺序、乱序）。

记录用户作答情况，可选自动将做错的题目加入错题本。

提供收藏题目到指定收藏夹的功能。

题库刷题模式：

用户可以选择指定分类的题目。

系统直接展示题目及其正确答案。

提供"下一题"导航，方便用户快速浏览和复习。

手动添加题目：

允许用户通过结构化表单手动逐个添加新的题目到题库中。

包括输入题目文本、题型、选项、答案、解析、所属分类等信息。

基础用户认证和权限管理：

提供用户注册和登录功能。

通过访问令牌验证用户身份，保护系统API接口。

### 3.2 未来增强功能
更多文件格式支持： 扩展支持Excel、纯文本等更多格式的题库文档上传。

更智能的提取： 提升大模型在复杂数学公式、代码题等特殊题型识别和答案提取上的准确性。

多人协作： 支持多用户协作管理题库，包括权限控制和版本管理。

练习数据分析： 提供详细的练习数据统计和分析报告（如正确率趋势、知识点掌握情况、薄弱环节分析）。

移动端应用： 开发iOS/Android原生或混合式移动端应用。

多维度管理与练习： 支持根据难度、知识点标签等更多维度进行题目管理和练习。

自适应练习： 根据用户历史表现动态调整题目难度和类型，提供个性化的学习路径。

## 4. 性能需求
文件处理响应时间： 用户上传题库文档后，文件解析和题目提取应在合理时间内完成。对于中小型文档（例如，10MB以下），应在秒级响应；对于大型文档，应提供进度反馈并在可接受的时间范围内完成（例如，小于60秒）。

题目提取准确率： 系统应确保高准确率的题目内容和题型识别（例如，提取准确率达到90%以上），并提供便捷的纠错机制。

页面加载速度： 前端页面应在2秒内完成加载，关键交互（如切换分类、开始练习）响应时间应在500毫秒内。

并发处理能力： 系统应能支持至少50个并发用户同时进行文件上传、题目练习和刷题操作，并保持系统稳定性和响应速度。

数据存储与检索： 数据库查询（如题目列表、分类筛选）应在毫秒级响应，即使在大量数据（例如，10万+题目）情况下也能保持高效。

系统稳定性： 系统应保证7x24小时稳定运行，年故障时间（Downtime）低于0.1%（即99.9%的可用性），并具备健壮的异常处理和故障恢复机制。

可扩展性： 系统架构应具备良好的扩展性，能够根据用户量和数据量的增长，通过水平扩展或增加模块来满足需求。

数据安全性： 用户上传的文件和提取的题目内容应得到严格保护，敏感数据（如用户密码）应加密存储。系统应定期进行数据备份，确保数据安全和隐私保护。

## 5. 运行需求
### 5.1 用户界面 (UI)
简洁直观： 界面布局合理，功能模块划分明确，用户能够一目了然，轻松找到所需功能。避免复杂元素堆砌。

易用性与导航： 提供直观的导航菜单或按钮，帮助用户快速定位功能。界面元素和交互方式保持一致性，降低学习成本。

个性化设置： 未来可提供用户自定义界面布局、字体大小、颜色主题等选项。

信息展示： 文本内容清晰易读，图片和图表清晰展示，信息呈现直观明了。

交互反馈： 用户操作时提供及时反馈（例如，加载状态、成功/失败提示），确保用户了解系统响应。

跨平台兼容性： 界面采用响应式设计，能够自适应不同设备（桌面、平板、手机）和屏幕尺寸，提供一致的用户体验。

### 5.2 接口需求
**用户认证接口：**
- `POST /api/auth/register` - 注册新用户
- `POST /api/auth/login` - 用户登录并获取访问令牌
- `POST /api/auth/logout` - 用户登出
- `GET /api/auth/me` - 获取当前用户信息
- `PUT /api/auth/profile` - 修改用户个人信息
- `POST /api/auth/change-password` - 修改密码

**文件上传与处理接口：**
- `POST /api/files/upload` - 上传题库文件
- `GET /api/files/upload-status/{upload_id}` - 查询文件处理状态
- `GET /api/files/uploads` - 获取用户上传记录列表

**题目管理接口：**
- `POST /api/questions` - 手动添加新题目
- `GET /api/questions` - 获取题目列表（支持分页、筛选、搜索）
- `GET /api/questions/{question_id}` - 获取题目详情
- `PUT /api/questions/{question_id}` - 修改题目
- `DELETE /api/questions/{question_id}` - 删除题目
- `POST /api/questions/batch-move` - 批量移动题目到指定分类
- `POST /api/questions/batch-delete` - 批量删除题目

**分类管理接口：**
- `POST /api/categories` - 创建新分类
- `GET /api/categories` - 获取分类列表
- `GET /api/categories/{category_id}` - 获取分类详情
- `PUT /api/categories/{category_id}` - 修改分类
- `DELETE /api/categories/{category_id}` - 删除分类

**练习与刷题接口：**
- `POST /api/practice/sessions` - 开始练习会话
- `GET /api/practice/sessions/{session_id}/questions` - 获取练习题目
- `POST /api/practice/sessions/{session_id}/answers` - 提交答案
- `GET /api/practice/sessions/{session_id}/results` - 获取练习结果
- `GET /api/study/questions` - 获取刷题模式题目列表
- `POST /api/favorites` - 添加收藏
- `DELETE /api/favorites/{question_id}` - 取消收藏
- `GET /api/favorites` - 获取收藏列表
- `GET /api/wrong-answers` - 获取错题本
- `DELETE /api/wrong-answers/{question_id}` - 从错题本移除

**第三方服务接口：**
- 大模型API接口：调用第三方大模型服务（如硅基流动、OpenAI）进行文档内容提取、题型识别和结构化
- 文件存储服务接口：与云存储服务（如阿里云OSS、腾讯云COS）交互，存储用户上传的原始文档
- 邮件服务接口：用于发送注册验证、密码重置等邮件

**系统管理接口：**
- `GET /api/admin/stats` - 获取系统统计信息
- `GET /api/admin/users` - 管理用户列表
- `GET /api/admin/logs` - 获取系统日志
- `POST /api/feedback` - 用户反馈提交

## 6. 其它需求
### 6.1 系统稳定性
高可靠性： 系统应保证长时间稳定运行，避免频繁的系统崩溃或故障。

容错能力： 能够处理异常情况并提供友好的错误提示，避免用户操作中断或数据丢失。

监控与告警： 建立完善的监控系统和告警机制，及时发现和处理潜在问题。

版本控制： 采用版本管理工具，严格管理代码变更，确保系统代码的稳定性和一致性。

### 6.2 可维护性
模块化架构： 系统采用模块化设计，将功能拆分成独立的模块，便于维护和更新。

代码质量： 编写清晰、简洁、规范的代码，提供详细注释，提高代码可读性。

技术文档： 建立详细的技术文档，为后续的维护和升级提供支持。

技术更新： 定期评估和更新系统所使用的技术和组件，确保系统与时俱进。

### 6.3 安全性
用户身份验证与权限控制： 确保用户数据和系统的安全，防止未经授权的访问。

数据加密： 对用户上传的文件和提取的文字内容进行加密处理，保护用户隐私和数据安全。

数据备份与恢复： 定期进行数据备份，确保数据不丢失，并具备快速恢复能力。

安全审计： 记录关键操作，进行安全审计，及时发现并应对潜在的安全威胁。

## 7. 开发路线与技术方案概述
### 7.1 开发路线 (MVP)
**第一阶段：基础架构与核心功能**
1. 搭建项目基础架构（前后端分离）
2. 实现用户认证系统（注册、登录、权限管理）
3. 设计并实现数据库结构
4. 实现基本的题目和分类管理功能
5. 开发文件上传功能

**第二阶段：智能提取与练习功能**
1. 集成大模型API，实现文档智能提取
2. 支持Word、PDF、图片格式的题目提取
3. 实现练习模式（顺序/乱序、计时、错题记录）
4. 实现刷题模式（快速浏览、答案展示）
5. 开发收藏和错题本功能

**第三阶段：优化与增强**
1. 优化用户界面和交互体验
2. 添加数据统计和分析功能
3. 实现批量操作和高级筛选
4. 性能优化和安全加固
5. 部署和运维配置

### 7.2 后端技术方案
**技术栈选择：**
- **开发语言：** Python 3.9+
- **Web框架：** Flask（轻量级、灵活）
- **数据库：** MySQL（主数据库）+ Redis（缓存）
- **ORM：** SQLAlchemy + Flask-Migrate（数据库迁移）
- **认证：** JWT Token + bcrypt（密码加密）
- **文件处理：** python-docx, PyPDF2, Pillow
- **任务队列：** Celery + Redis（异步文件处理）
- **API文档：** Flask-RESTX（Swagger文档生成）

**架构设计：**
- 采用分层架构：Controller -> Service -> Repository -> Model
- 使用依赖注入模式，便于测试和维护
- 异步处理文件上传和大模型调用
- 实现统一的错误处理和日志记录

### 7.3 前端技术方案
**技术栈选择：**
- **前端框架：** Vue 3 + TypeScript
- **构建工具：** Vite（快速开发和构建）
- **状态管理：** Pinia（Vue官方推荐状态管理）
- **数据获取：** Axios + Vue Query（服务器状态管理）
- **UI组件库：** Element Plus（Vue生态成熟组件库）
- **样式方案：** SCSS + CSS Modules
- **路由：** Vue Router v4
- **表单处理：** VeeValidate + Yup（表单验证）
- **图标：** Element Plus Icons

**项目结构：**
```
src/
├── components/     # 通用组件
├── views/         # 页面组件
├── composables/   # 组合式函数
├── services/      # API服务
├── stores/        # 状态管理
├── types/         # TypeScript类型定义
├── utils/         # 工具函数
└── styles/        # 样式文件
```

### 7.4 部署与运维方案
**部署方案：**
- **生产部署：** 云服务器 + Nginx + Gunicorn
- **数据库：** MySQL（可使用云数据库服务）
- **缓存：** Redis
- **文件存储：** 本地存储或云对象存储
- **反向代理：** Nginx（负载均衡、SSL终止）

**CI/CD流程：**
- **版本控制：** Git + GitHub
- **自动化测试：** pytest（后端）+ Vitest（前端）
- **自动化部署：** GitHub Actions
- **代码质量：** ESLint, Prettier, Black, isort

**监控与日志：**
- **应用监控：** 自定义健康检查接口
- **日志管理：** Python logging + 日志轮转
- **性能监控：** 数据库查询优化、API响应时间监控
- **错误追踪：** 统一异常处理和错误日志

## 8. 附录
### 8.1 技术调研
**市场调研：**
- 分析了现有题库管理系统（如Anki、Quizlet等）的功能特点和用户体验
- 研究了在线教育平台的题目管理和练习模式设计
- 调研了文档解析和AI提取技术的应用案例

**技术可行性：**
- **大模型集成：** 验证了主流大模型API（GPT、Claude、国产大模型）的文档解析能力
- **文件处理：** 测试了Python生态中各种文档解析库的效果和性能
- **数据库选型：** 对比了MySQL在性能、稳定性和生态支持方面的优势
- **前端技术：** 评估了Vue生态的成熟度和开发效率

### 8.2 开发规范
**代码规范：**
- **Python：** 遵循PEP 8规范，使用Black格式化，isort排序导入
- **Vue/TypeScript：** 使用ESLint + Prettier，严格类型检查
- **Git：** 使用Conventional Commits规范提交信息
- **文档：** 代码注释、API文档、README文档完整

**数据库规范：**
- 表名使用小写下划线命名
- 字段名使用小写下划线命名
- 必须有created_at和updated_at字段
- 外键约束和索引优化
- 数据迁移脚本版本管理

**API设计规范：**
- RESTful API设计原则
- 统一的响应格式和错误码
- API版本管理（/api/v1/）
- 请求参数验证和响应数据序列化
- 完整的API文档和示例

**安全规范：**
- JWT Token认证，设置合理过期时间
- 密码使用bcrypt加密存储
- 输入数据验证和SQL注入防护
- CORS配置和HTTPS强制
- 敏感信息环境变量管理

### 8.3 项目里程碑

**里程碑1（第1-2周）：** 项目初始化和基础架构
- 项目结构搭建
- 数据库设计和初始化
- 用户认证系统
- 基础API框架

**里程碑2（第3-4周）：** 核心功能开发
- 题目和分类管理
- 文件上传功能
- 基础前端界面

**里程碑3（第5-6周）：** 智能提取和练习功能
- 大模型API集成
- 文档解析和题目提取
- 练习和刷题模式

**里程碑4（第7-8周）：** 完善和优化
- 错题本和收藏功能
- 用户体验优化
- 性能优化和测试
- 部署和上线